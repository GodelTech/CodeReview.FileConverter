using System.Collections.Generic;
using System.Linq;
using Newtonsoft.Json;

namespace GodelTech.CodeReview.FileConverter.Models.DependencyCheck
{
    public class Vulnerability
    {
        [JsonConstructor]
        public Vulnerability(
            string name,
            string severity,
            Cvssv2 cvssv2,
            Cvssv3 cvssv3,
            string description,
            IEnumerable<Reference> references)
        {
            Name = name;
            Cvssv2 = cvssv2;
            Cvssv3 = cvssv3;
            Description = description;
            References = references;
            Severity = severity;
        }

        public string Name { get; }
        public Cvssv2 Cvssv2 { get; }
        public Cvssv3 Cvssv3 { get; }
        public string Severity { get; }
        public string Description { get; }
        public IEnumerable<Reference> References { get; }
        [JsonIgnore]
        public string DetailsUrl => References.FirstOrDefault()?.Url ?? string.Empty;
    }
}
